import{_ as Z,l as n,f as a,j as l,i as ce,p as de,d as X,C as re,G as B,a as W,w as ie,W as ve,o as me,s as S,B as R,F as O,m as N,aO as fe,u as w,at as pe,L as _e,aD as he,aG as ge,r as be,A as Ee,k as x,q as G,y as Ce,z as ye,x as ee,I as te,aF as we,aI as ke,av as Ie}from"./seventv.index.3.0.15.1000.js";import{a as Oe,f as Te,g as Se,h as Ae,u as Me,o as $e}from"./seventv.index.3.0.15.10003.js";import{u as ae}from"./seventv.main.3.0.15.1000.js";import{u as le}from"./seventv.useChannelContext.3.0.15.1000.js";import{_ as z,d as Fe,c as Ve,a as xe,G as Le,b as Re}from"./seventv.StoreSubscribeButton.3.0.15.1000.js";import{b as U,r as T,t as J,u as m,n as Pe}from"./seventv.preload-helper.3.0.15.1000.js";import{d as ue}from"./seventv.ReactHooks.3.0.15.1000.js";import{u as De}from"./seventv.useChatEmotes.3.0.15.1000.js";import{D as Be,u as Ue,a as je}from"./seventv.Settings.3.0.15.1000.js";import{u as Ne}from"./seventv.useCosmetics.3.0.15.1000.js";import{u as Ke}from"./seventv.useUpdater.3.0.15.1000.js";import{E as Ge,_ as ze}from"./seventv.Emote.3.0.15.1000.js";import{d as oe}from"./seventv.Transform.3.0.15.1000.js";import{U as Je}from"./seventv.UiFloating.3.0.15.1000.js";const Ze={},qe={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},He=l("path",{d:"M11.3733 5.68667C11.3733 6.94156 10.966 8.10077 10.2797 9.04125L13.741 12.5052C14.0827 12.8469 14.0827 13.4019 13.741 13.7437C13.3992 14.0854 12.8442 14.0854 12.5025 13.7437L9.04125 10.2797C8.10077 10.9687 6.94156 11.3733 5.68667 11.3733C2.54533 11.3733 0 8.828 0 5.68667C0 2.54533 2.54533 0 5.68667 0C8.828 0 11.3733 2.54533 11.3733 5.68667ZM5.68667 9.62359C7.86018 9.62359 9.62359 7.86018 9.62359 5.68667C9.62359 3.51316 7.86018 1.74974 5.68667 1.74974C3.51316 1.74974 1.74974 3.51316 1.74974 5.68667C1.74974 7.86018 3.51316 9.62359 5.68667 9.62359Z",fill:"currentColor"},null,-1),We=[He];function Xe(u,f){return n(),a("svg",qe,We)}const Ye=Z(Ze,[["render",Xe]]),se=Symbol("seventv-emote-menu-context");function Y(){let u=ce(se,null);return u||(u=U({open:!1,filter:"",channelID:""}),de(se,u)),u}const Qe={mounted(u,f){const{value:p}=f;p("mounted",u)},updated(u,f){const{value:p}=f;p("updated",u)},beforeUnmount(u,f){const{value:p}=f;p("unmounted",u)}},et=["collapsed","ephemeral"],tt={class:"seventv-set-header"},ot={class:"seventv-set-header-icon"},st=["src"],nt={class:"seventv-set-name"},rt={key:0,class:"seventv-emote-set"},it=["disabled","ratio","load-state","set-id","emote-id","zero-width","favorite","onClick","onKeydown"],at=X({__name:"EmoteMenuSet",props:{es:{},ephemeral:{type:Boolean}},emits:["emote-clicked","emotes-updated"],setup(u,{expose:f,emit:p}){const c=u,{t:P,te:E}=re(),V=Y(),A=T([]),L=T(),k=T(!1),h=B("ui.emote_menu.collapsed_sets"),C=B("ui.emote_menu.favorites"),g=B("ui.emote_menu.usage"),{alt:y}=Oe(),M=T(j());function $(e){if(c.es.id==="USAGE"){const t=g.value.get(e.id)??0;return t-t*2||0}let i=oe(e);return(e.flags||0)!==0&&(i-=.5),i}const D=ue((e="")=>{const i=[];if(!(c.es.provider&&!c.es.emotes.length)){for(const t of c.es.emotes)e&&!t.name.toLowerCase().includes(e.toLowerCase())||i.push(t);i.sort((t,o)=>{const _=$(t),Q=$(o);return _==Q?t.name.localeCompare(o.name):_>Q?1:-1}),A.value=i,p("emotes-updated",i)}},25);function d(e,i){return e.scope==="PERSONAL"&&i.data&&i.data.state&&!i.data.state.includes("PERSONAL")}function v(e){if(!d(c.es,e)){if(y.value){C.value.has(e.id)?C.value.delete(e.id):C.value.add(e.id),C.value=new Set(C.value);return}p("emote-clicked",e)}}function b(){const e=`emote_menu.sets.${c.es.name}`;return E(e)?P(e):c.es.name}Te("Escape",()=>{V.open=!1}),W(()=>c.es.emotes,()=>{D(V.filter)}),ie(()=>{D(V.filter)});const s=U({}),I=T(!1),K=c.es.provider!=="EMOJI";let F;function q(){F||(F=new IntersectionObserver(e=>{e.forEach(async i=>{const t=i.target.getAttribute("emote-id");if(i.isIntersecting&&!s[t]){const o=s[t]===-1;s[t]=0,K&&!o&&I.value&&await _e(he(100)).toBeTruthy()}if(s[t]===0&&!i.isIntersecting){delete s[t];return}if(i.isIntersecting&&s[t]===0){s[t]=1;return}!i.isIntersecting&&s[t]>=0&&(s[t]=s[t]===1?-1:0)}),I.value=!0}),k.value=!0)}function H(e,i){if(F)for(let t=0;t<i.children.length;t++){const o=i.children.item(t);if(!o)continue;const _=o.getAttribute("emote-id");!_||s[_]||(e==="mounted"||e==="updated"?F.observe(o):F.unobserve(o))}}function j(){return h.value?h.value.has(c.es.id):!1}function r(){h.value&&(j()?(h.value.delete(c.es.id),M.value=!1):(h.value.add(c.es.id),M.value=!0),h.value=new Set(h.value))}return ve(()=>{q()}),me(()=>{F&&F.disconnect()}),f({containerEl:L}),(e,i)=>e.ephemeral||A.value.length?(n(),a("div",{key:0,ref_key:"containerEl",ref:L,class:"seventv-emote-set-container",collapsed:M.value,ephemeral:e.ephemeral},[l("div",tt,[l("div",ot,[e.es.owner&&e.es.owner.avatar_url?(n(),a("img",{key:0,src:e.es.owner.avatar_url},null,8,st)):(n(),S(z,{key:1,class:"logo",provider:e.es.provider},null,8,["provider"]))]),l("span",nt,J(b()),1),l("div",{class:"seventv-set-chevron",onClick:r},[e.ephemeral?(n(),S(Fe,{key:1})):(n(),S(Be,{key:0}))])]),k.value?R((n(),a("div",rt,[(n(!0),a(O,null,N(A.value,t=>{var o;return n(),a("div",{key:t.id,class:"seventv-emote-container",disabled:d(e.es,t),ratio:m(oe)(t),"load-state":s[t.id],"set-id":e.es.id,"emote-id":t.id,"zero-width":(t.flags||0)!==0,favorite:((o=m(C))==null?void 0:o.has(t.id))&&e.es.id!=="FAVORITE",tabindex:"0",onClick:_=>v(t),onKeydown:fe(ge(_=>v(t),["prevent"]),["enter"])},[s[t.id]?(n(),S(Ge,{key:0,emote:t,unload:!s[t.id]},null,8,["emote","unload"])):w("",!0)],40,it)}),128))])),[[m(Qe),H]]):w("",!0),pe(e.$slots,"default",{},void 0,!0)],8,et)):w("",!0)}});const ne=Z(at,[["__scopeId","data-v-f9258bfc"]]),lt=u=>(Ce("data-v-63ab9832"),u=u(),ye(),u),ut={class:"seventv-emote-menu-tab-container"},ct={class:"seventv-promotion-personal-emotes"},dt={key:2,class:"seventv-promotion-personal-emotes"},vt=lt(()=>l("strong",null,"ALT",-1)),mt={class:"seventv-emote-menu-tab-sidebar"},ft={class:"seventv-emote-menu-sidebar-icons"},pt=["selected","onClick"],_t={class:"seventv-emote-menu-set-sidebar-icon"},ht={key:0,class:"seventv-emote-menu-emoji-group"},gt=["src"],bt={class:"seventv-emote-menu-settings-button-container"},Et={key:0,class:"seventv-emote-menu-settings-button-update-flair"},Ct=X({__name:"EmoteMenuTab",props:{provider:{},selected:{type:Boolean}},emits:["emote-clicked","provider-visible","toggle-settings","toggle-native-menu"],setup(u,{emit:f}){var j;const p=u,{t:c}=re(),P=Y(),E=le(P.channelID),V=De(E),A=Ke(),L=T(""),k=V.byProvider(p.provider)??U({}),h=ae(),C=Ne(((j=h.identity)==null?void 0:j.id)??""),g=Ue(),y=U(new Set),M=T([]),$=B("ui.emote_menu.favorites"),D=["1f603","1f44b","1f343","1f354","26bd","1f698","1f4a1","1f523","1f6a9"],d=["Smileys & Emotion","People & Body","Animals & Nature","Food & Drink","Activities","Travel & Places","Objects","Symbols","Flags"],v={id:"personal-ad",name:"Personal Emotes",emotes:[]};function b(){return $.value?Array.from($.value.values()).map(r=>V.find(e=>e.id===r)).filter(r=>!!r):[]}if(p.provider==="FAVORITE"){const r=k.FAVORITE=U({id:"FAVORITE",name:c("emote_menu.favorite_set"),emotes:b()});W($,()=>{r.emotes=b()})}function s(){return p.provider==="FAVORITE"&&k.FAVORITE.emotes.length>0}function I(r,e){if(!e||!e.length)return;const i=e[0];i.containerEl&&(L.value=r,i.containerEl.scrollIntoView({behavior:"auto"}))}function K(r){return r.scope==="GLOBAL"?1:E.id&&r.owner&&r.owner.id===E.id?-1:(r.flags??0)&4?-2:0}function F(r,e){const i=K(r),t=K(e);return r.provider==="EMOJI"&&e.provider==="EMOJI"&&d.indexOf(r.name)>-1&&d.indexOf(e.name)>-1?d.indexOf(r.name)-d.indexOf(e.name):i==t?r.name.localeCompare(e.name):i>t?1:-1}function q(r,e){e?y.add(r.id):y.delete(r.id),f("provider-visible",!!y.size)}const H=ue(()=>{var e;const r=Object.values(k);if((e=C.emoteSets)!=null&&e.size&&r.push(...Array.from(C.emoteSets.values()).filter(i=>i.provider===p.provider)),p.provider==="PLATFORM"){const i=r.reduce((t,o)=>{const _=t[o.name];return _?_.emotes.push(...o.emotes):t[o.name]={set:o,emotes:[...o.emotes]},t},{});r.splice(0,r.length,...Object.values(i).map(t=>({...t.set,emotes:t.emotes})))}r.sort(F),M.value=r},50);return W(()=>[P.filter,k,C.emoteSets],H,{immediate:!0}),(r,e)=>{const i=be("i18n-t"),t=Ee("t");return n(),a("div",ut,[x(xe,null,{default:G(()=>[r.provider==="PLATFORM"?(n(),a("div",{key:0,class:"seventv-native-menu-toggle",onClick:e[0]||(e[0]=o=>f("toggle-native-menu"))},[x(z,{provider:"PLATFORM"}),R(l("span",null,null,512),[[t,"emote_menu.native"]])])):w("",!0),r.provider==="7TV"&&!m(g).sub?(n(),S(ne,{key:1,es:v,ephemeral:!0},{default:G(()=>[l("div",ct,[l("div",null,[R(l("p",null,null,512),[[t,"emote_menu.personal_emotes_promo_1"]]),l("span",null,J(m(c)("emote_menu.personal_emotes_promo_2",{PLATFORM:m(h).platform.charAt(0)+m(h).platform.slice(1).toLowerCase()})),1)]),x(Ve)])]),_:1})):w("",!0),r.provider==="FAVORITE"&&!s()?(n(),a("div",dt,[l("div",null,[R(l("p",null,null,512),[[t,"emote_menu.favorite_emotes_hint_1"]]),x(i,{keypath:"emote_menu.favorite_emotes_hint_2",tag:"span"},{HOTKEY:G(()=>[vt]),_:1})])])):w("",!0),(n(!0),a(O,null,N(M.value,o=>(n(),a(O,{key:o.id},[o.emotes.length?(n(),S(ne,{key:0,ref_for:!0,ref:"es-"+o.id,es:o,onEmoteClicked:e[1]||(e[1]=_=>f("emote-clicked",_)),onEmotesUpdated:_=>q(o,!!_.length)},null,8,["es","onEmotesUpdated"])):w("",!0)],64))),128))]),_:1}),l("div",mt,[l("div",ft,[(n(!0),a(O,null,N(M.value,o=>(n(),a(O,{key:o.id},[o.emotes.length?(n(),a("div",{key:0,class:"seventv-emote-menu-set-sidebar-icon-container",selected:L.value==o.id,onClick:_=>I(o.id,r.$refs["es-"+o.id])},[l("div",_t,[o.provider==="EMOJI"&&d.indexOf(o.name)>-1?(n(),a("div",ht,[x(ze,{id:D[d.indexOf(o.name)],alt:o.name},null,8,["id","alt"])])):o.owner&&o.owner.avatar_url?(n(),a("img",{key:1,src:o.owner.avatar_url},null,8,gt)):(n(),S(z,{key:2,class:"logo",provider:o.provider},null,8,["provider"]))])],8,pt)):w("",!0)],64))),128))]),l("div",bt,[l("div",{class:"seventv-emote-menu-settings-button",onClick:e[2]||(e[2]=o=>f("toggle-settings"))},[x(Le,{provider:"7TV"}),m(A).isUpToDate?w("",!0):(n(),a("div",Et))])])])])}}});const yt=Z(Ct,[["__scopeId","data-v-63ab9832"]]),wt={class:"seventv-emote-menu-providers"},kt=["selected","onClick"],It={key:0,class:"seventv-emote-menu-search"},Ot={class:"search-icon"},Tt=X({__name:"EmoteMenu",props:{anchorEl:{},width:{},scale:{}},emits:["emote-click","toggle-native-menu","close"],setup(u,{emit:f}){const p=u,c=T(),P=le(),E=Y();E.channelID=P.id;const V=je(),{providers:A,platform:L}=ae(),k=T(),h=B("ui.emote_menu_search"),C=B("ui.emote_menu.default_tab","7TV"),g=T(C.value),y=U({FAVORITE:!0,"7TV":A.has("7TV"),FFZ:A.has("FFZ"),BTTV:A.has("BTTV"),PLATFORM:!0,EMOJI:!0});ie(()=>{c.value&&(c.value.style.setProperty("--width",p.width??"unset"),c.value.style.setProperty("--seventv-emote-menu-scale",p.scale??"3rem"),k.value&&k.value.focus())});const M=Se("Control",{initial:!1});Ae("e",d=>{M.value&&($(),d.preventDefault())}),Me("keydown",d=>{if(!["ArrowUp","ArrowDown"].includes(d.key))return;const v=Object.keys(y).indexOf(g.value??"7TV"),b=d.key==="ArrowUp"?v+1:v-1,s=Object.keys(y)[b];s&&(g.value=s)});function $(){E.open=!E.open}function D(d,v){var b;y[d]=v,!v&&d===g.value&&(g.value=((b=Object.entries(y).slice(1).find(([,s])=>s))==null?void 0:b[0])??"7TV")}return $e(c,d=>{f("close",d)}),(d,v)=>(n(),S(Je,{anchor:d.anchorEl,placement:"top-end",middleware:[m(ke)({padding:4,mainAxis:!0,crossAxis:!0}),m(Ie)({mainAxis:4,crossAxis:-4})]},{default:G(()=>[m(E).open&&m(E).channelID?(n(),a("div",{key:0,ref_key:"containerRef",ref:c,class:"seventv-emote-menu"},[l("div",{class:Pe(["seventv-emote-menu-header",{"disabled-search-input":m(h)}])},[l("div",wt,[(n(!0),a(O,null,N(y,(b,s)=>(n(),a(O,null,[b||s===g.value?(n(),a("div",{key:s,class:"seventv-emote-menu-provider-icon",selected:s===g.value,onClick:I=>g.value=s},[s!=="FAVORITE"?(n(),S(z,{key:0,provider:s},null,8,["provider"])):(n(),S(Re,{key:1})),R(l("span",null,[s==="PLATFORM"?(n(),a(O,{key:0},[ee(J(m(L)),1)],64)):(n(),a(O,{key:1},[ee(J(s),1)],64))],512),[[te,s===g.value]])],8,kt)):w("",!0)],64))),256))]),m(h)?w("",!0):(n(),a("div",It,[R(l("input",{ref_key:"searchInputRef",ref:k,"onUpdate:modelValue":v[0]||(v[0]=b=>m(E).filter=b),class:"seventv-emote-menu-search-input",autofocus:""},null,512),[[we,m(E).filter]]),l("div",Ot,[x(Ye)])]))],2),(n(!0),a(O,null,N(y,(b,s)=>R((n(),a("div",{key:s,class:"seventv-emote-menu-body"},[x(yt,{provider:s,selected:s===g.value,onEmoteClicked:v[1]||(v[1]=I=>f("emote-click",I)),onProviderVisible:I=>D(s,I),onToggleSettings:v[2]||(v[2]=I=>m(V).toggle()),onToggleNativeMenu:v[3]||(v[3]=I=>[$(),f("toggle-native-menu")])},null,8,["provider","selected","onProviderVisible"])])),[[te,s===g.value]])),128))],512)):w("",!0)]),_:1},8,["anchor","middleware"]))}});const Nt=Z(Tt,[["__scopeId","data-v-76a9e4f8"]]);export{Nt as E,Y as u};
