import{c as $,d as A,e as B,u as b}from"./seventv.ReactHooks.3.0.15.1000.js";import{d as H}from"./seventv.useModule.3.0.15.1000.js";import{d as g,as as z,G as C,a as k,w as E,ar as O,aq as F,a4 as I,al as x,l as p,f as m,m as V,s as P,F as v,u as L,_ as S,j as d,y as T,z as N,k as M,Z as D,aJ as W,ak as w}from"./seventv.index.3.0.15.1000.js";import{l as G,r as h,u as y,t as f,b as j}from"./seventv.preload-helper.3.0.15.1000.js";const q=g({__name:"PlayerContentWarning",props:{inst:{}},setup(l){return z(l.inst.component,"props",{value(c){var r,i;const t=(i=(r=c.children)==null?void 0:r.props)==null?void 0:i.onAcknowledge;typeof t=="function"&&(t(),G.info("<Player>","Acknowledged content warning",`(${c.restriction})`))}}),(c,t)=>null}}),U=g({__name:"PlayerController",props:{inst:{},mediaPlayer:{}},setup(l){const e=l,c=C("player.skip_content_restriction"),t=C("player.action_onclick"),r=h(null),i=h(null),n=A(()=>{r.value&&$(r.value),r.value=B({parentSelector:".seventv-player",predicate:a=>a.props&&typeof a.props.restrictions=="object"&&typeof a.props.liftRestriction=="function"})},100);k(c,a=>{a&&n()},{immediate:!0}),E(()=>{var a;if((a=e.inst.component)!=null&&a.props){if(e.inst.component.props.containerRef instanceof HTMLDivElement){const u=e.inst.component.props.containerRef;u&&u.classList.toggle("seventv-player-hide-content-warning",c.value),e.inst.component.props.containerRef.classList.add("seventv-player")}if(e.mediaPlayer){const u=e.mediaPlayer.core.mediaSinkManager.video;if(!u||!u.nextElementSibling||(i.value=u.nextElementSibling.querySelector("div[data-a-target='player-overlay-click-handler']"),!i.value))return;t.value===1?O(i.value,"PlayerActionOnClick","click",_):t.value===2?O(i.value,"PlayerActionOnClick","click",s):F(i.value,"PlayerActionOnClick","click")}}});function _(){e.mediaPlayer&&(e.mediaPlayer.isPaused()?e.mediaPlayer.play():e.mediaPlayer.pause())}function s(){e.mediaPlayer&&e.mediaPlayer.setMuted(!e.mediaPlayer.isMuted())}function o(){e.mediaPlayer}return k(t,o),I(()=>{r.value&&$(r.value),x(e.inst.component.props.mediaPlayerInstance.core.state,"liveLatency"),x(e.inst.component,"props"),i.value&&F(i.value,"PlayerActionOnClick","click")}),(a,u)=>y(c)&&r.value?(p(!0),m(v,{key:0},V(r.value.instances,R=>(p(),P(q,{key:R.identifier,inst:R},null,8,["inst"]))),128)):L("",!0)}});const J={},Z={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",height:"1em",width:"1em"},K=d("path",{d:"M52.5 440.6c-9.5 7.9-22.8 9.7-34.1 4.4S0 428.4 0 416V96C0 83.6 7.2 72.3 18.4 67s24.5-3.6 34.1 4.4L224 214.3V256v41.7L52.5 440.6zM256 352V256 128 96c0-12.4 7.2-23.7 18.4-29s24.5-3.6 34.1 4.4l192 160c7.3 6.1 11.5 15.1 11.5 24.6s-4.2 18.5-11.5 24.6l-192 160c-9.5 7.9-22.8 9.7-34.1 4.4s-18.4-16.6-18.4-29V352z"},null,-1),Q=[K];function X(l,e){return p(),m("svg",Z,Q)}const Y=S(J,[["render",X]]),ee={},te={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor",height:"1em",width:"1em"},ae=d("path",{d:"M0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm320 96c0-26.9-16.5-49.9-40-59.3V88 64H232V88 292.7c-23.5 9.5-40 32.5-40 59.3c0 35.3 28.7 64 64 64s64-28.7 64-64zM144 176a32 32 0 1 0 0-64 32 32 0 1 0 0 64zm-16 80a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zm288 32a32 32 0 1 0 0-64 32 32 0 1 0 0 64zM400 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"},null,-1),ne=[ae];function oe(l,e){return p(),m("svg",te,ne)}const re=S(ee,[["render",oe]]),se=l=>(T("data-v-fa648ba1"),l=l(),N(),l),ie={class:"seventv-tooltip","tooltip-type":"video-stats"},le={class:"details"},ce=se(()=>d("div",{class:"tooltip-title"},[d("p",null,"Stream Latency")],-1)),pe=g({__name:"PlayerStatsTooltip",props:{bitrate:{},playbackRate:{},droppedFrames:{},height:{},width:{},framerate:{},bufferSize:{}},setup(l){const e=l;return(c,t)=>(p(),m("div",ie,[d("div",le,[d("p",null,"Video: "+f(e.width)+"x"+f(e.height),1),d("p",null,"Framerate: "+f(e.framerate),1),d("p",null,"Bitrate: "+f(e.bitrate)+" kbps",1),d("p",null,"Dropped Frames: "+f(e.droppedFrames),1),d("p",null,"Playback Rate: "+f(e.playbackRate.toFixed(2))+"x",1),d("p",null,"Buffer Size: "+f(e.bufferSize.toFixed(2))+"s",1)]),ce]))}});const de=S(pe,[["__scopeId","data-v-fa648ba1"]]),ue={key:0},me={key:1},fe=g({__name:"PlayerStreamInfo",props:{inst:{},advancedControls:{},mediaPlayer:{}},setup(l){const e=l,c=h("-.--"),t=j({droppedFrames:0,playbackRate:0,bitrate:"0",width:0,height:0,framerate:0,bufferSize:0}),r=document.createElement("seventv-container"),i=h(),n=W(de,t);function _(){const s=e.advancedControls.component,o=document.querySelector("[data-a-target='player-overlay-video-stats']");s.setStatsOverlay(o?0:1)}return E(()=>{var a,u;const s=e.inst.domNodes.root;if(!s)return;const o=(a=s.querySelector("span.live-time"))==null?void 0:a.parentElement;!o||(u=o.parentElement)!=null&&u.contains(r)||o.insertAdjacentElement("afterend",r)}),k(c,()=>{e.mediaPlayer&&(t.droppedFrames=e.mediaPlayer.getDroppedFrames(),t.bitrate=(e.mediaPlayer.getVideoBitRate()/1e3).toFixed(0)??"0",t.framerate=e.mediaPlayer.getVideoFrameRate(),t.playbackRate=e.mediaPlayer.getPlaybackRate(),t.width=e.mediaPlayer.getVideoWidth(),t.height=e.mediaPlayer.getVideoHeight(),t.bufferSize=e.mediaPlayer.getBufferDuration())},{immediate:!0}),k(()=>e.mediaPlayer,(s,o)=>{if(o&&s!==o)x(o.core.state,"liveLatency");else{if(!s)return;z(s.core.state,"liveLatency",{value:a=>{c.value=(a==null?void 0:a.toFixed(2))??"-.--"}})}},{immediate:!0}),I(()=>{r.remove()}),(s,o)=>(p(),P(D,{to:y(r)},[d("div",{ref_key:"videoStatsRef",ref:i,class:"seventv-video-stats",onClick:_,onMouseenter:o[0]||(o[0]=a=>y(n).show(i.value)),onMouseleave:o[1]||(o[1]=a=>y(n).hide())},[t.playbackRate>1?(p(),m("figure",ue,[M(Y)])):(p(),m("figure",me,[M(re)])),d("span",null,f(c.value)+"s",1)],544)],8,["to"]))}});const ye=S(fe,[["__scopeId","data-v-775bbc80"]]),_e=[w("player.skip_content_restriction","TOGGLE",{label:"Skip Content Warnings",hint:"Automatically skip the 'intended for mature audiences' dialog on some streams",path:["Player",""],defaultValue:!1}),w("player.video_stats","TOGGLE",{path:["Player",""],label:"Video Stats",hint:"Show Latency to Broadcaster with a tooltip of other video stats",defaultValue:!1}),w("player.action_onclick","DROPDOWN",{path:["Player",""],label:"Action on Click",hint:"Choose an action to perform when clicking on the video player. (This setting may not work in channels with extensions shown)",options:[["None",0],["Pause/Unpause",1],["Mute/Unmute",2]],defaultValue:0})],ve=g({__name:"PlayerModule",setup(l){H("player",{name:"Player",depends_on:[]});const e=h(),c=C("player.video_stats"),t=b({parentSelector:".persistent-player",predicate:n=>n.props&&n.props.containerRef&&n.props.mediaPlayerInstance},{hooks:{render(n,_){return e.value=n.component.props.mediaPlayerInstance,_}}}),r=b({parentSelector:".persistent-player",predicate:n=>n.props&&n.setStatsOverlay&&n.setShowControls}),i=b({parentSelector:"#live-channel-stream-information",predicate:n=>n.props&&n.props.liveSince},{trackRoot:!0});return(n,_)=>(p(),m(v,null,[(p(!0),m(v,null,V(y(t).instances,s=>(p(),P(U,{key:s.identifier,inst:s,"media-player":e.value},null,8,["inst","media-player"]))),128)),(p(!0),m(v,null,V(y(i).instances,(s,o)=>(p(),m(v,{key:s.identifier},[y(c)?(p(),P(ye,{key:0,inst:s,"advanced-controls":y(r).instances[o],"media-player":e.value},null,8,["inst","advanced-controls","media-player"])):L("",!0)],64))),128))],64))}}),Se=Object.freeze(Object.defineProperty({__proto__:null,config:_e,default:ve},Symbol.toStringTag,{value:"Module"}));export{Se as _};
