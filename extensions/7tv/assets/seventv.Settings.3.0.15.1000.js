var M=Object.defineProperty;var H=(s,e,t)=>e in s?M(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var p=(s,e,t)=>(H(s,typeof e!="symbol"?e+"":e,t),t);import{aQ as F,i as D,p as G,a as $,_ as m,l as a,f as r,j as c,d as b,aR as Q,k as w,q as V,x as I,u as y,F as E,m as A,aS as K,aT as W,aU as Y,y as O,z as U,a1 as J,s as X,A as Z,B as ee,aL as P,a0 as B}from"./seventv.index.3.0.15.1000.js";import{b as T,M as te,r as k,u as l,t as h,l as S,d as se,m as ne,_ as j}from"./seventv.preload-helper.3.0.15.1000.js";import{u as oe}from"./seventv.main.3.0.15.1000.js";import{U as R,S as ie,a as z,C as ae}from"./seventv.StoreSubscribeButton.3.0.15.1000.js";import{b as re}from"./seventv.seventv.user.gql.3.0.15.1000.js";import{r as ce}from"./seventv.index.3.0.15.10002.js";import{j as ue}from"./seventv.index.3.0.15.10003.js";const L={api:"https://egvault.7tv.io/v1"},le=F("egvault",{state:()=>({subscription:null,products:[],currentProduct:null,currentPlan:null}),getters:{subscribed:s=>{var e;return((e=s.subscription)==null?void 0:e.active)??!1},subEndDate:s=>{var e;return(e=s.subscription)!=null&&e.end_at?new Date(s.subscription.end_at):new Date(0)},subProduct:s=>s.products.find(e=>e.name==="subscription")},actions:{async fetchSub(s){const t=await(await fetch(`${L.api}/subscriptions/${s}`,{})).json();return this.subscription=t,t},async fetchProducts(){const e=await(await fetch(L.api+"/products")).json();return this.products=e,e}}}),N=Symbol("ActorContext");class _e{constructor(){p(this,"user",null);p(this,"sub",null);p(this,"platform",null);p(this,"platformUserID",null);p(this,"query",null)}setPlatformUserID(e,t){this.platform=e,this.platformUserID=t}openAuthorizeWindow(e){if(this.user)return;const t=window.open(`https://7tv.io/v3/auth?platform=${e}`,"7TV Auth","width=500,height=600");if(!t)return;const o=setInterval(()=>{var _;t.closed&&((_=this.query)==null||_.refetch(),clearInterval(o))},100)}logout(){fetch("https://7tv.io/v3/auth/logout",{method:"POST",credentials:"include"}).then(e=>{e.ok&&(this.user=null)})}}function pe(){const s=le();let e=D(N,null);return e||(e=T(new _e),e.query=ce(re,{},{}),e.query.onResult(t=>{var o;(o=t==null?void 0:t.data)!=null&&o.user&&(e.user=structuredClone(te(t.data.user)))}),G(N,e),$(()=>e.platformUserID,t=>{!t||!e.query||e.query.load(e.query.document.value,{id:e.platformUserID,platform:e.platform})},{immediate:!0}),$(()=>{var t;return(t=e.user)==null?void 0:t.id},t=>{t&&s.fetchSub(t).then(o=>{!o||!o.active||(e.sub=o)}).catch(()=>{})})),e}const de={},fe={width:"1em",height:"0.6666em",viewBox:"0 0 9 6",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},ve=c("path",{d:"M0.221974 4.46565L3.93498 0.251908C4.0157 0.160305 4.10314 0.0955723 4.19731 0.0577097C4.29148 0.0192364 4.39238 5.49454e-08 4.5 5.3662e-08C4.60762 5.23786e-08 4.70852 0.0192364 4.80269 0.0577097C4.89686 0.0955723 4.9843 0.160305 5.06502 0.251908L8.77803 4.46565C8.92601 4.63359 9 4.84733 9 5.10687C9 5.36641 8.92601 5.58015 8.77803 5.74809C8.63005 5.91603 8.4417 6 8.213 6C7.98431 6 7.79596 5.91603 7.64798 5.74809L4.5 2.17557L1.35202 5.74809C1.20404 5.91603 1.0157 6 0.786996 6C0.558296 6 0.369956 5.91603 0.221974 5.74809C0.0739918 5.58015 6.39938e-08 5.36641 6.08988e-08 5.10687C5.78038e-08 4.84733 0.0739918 4.63359 0.221974 4.46565Z"},null,-1),ge=[ve];function me(s,e){return a(),r("svg",fe,ge)}const St=m(de,[["render",me]]),x=s=>(O("data-v-616c201b"),s=s(),U(),s),he={class:"seventv-settings-backup"},we=x(()=>c("h3",null,"Backup",-1)),ye=x(()=>c("p",null,"Export your current settings or import from a settings file",-1)),Se={class:"seventv-settings-backup-buttons"},be={key:0},ke=x(()=>c("p",{class:"seventv-settings-backup-error"},"There was an error exporting/importing your settings!",-1)),Ce=[ke],Ve={key:1,class:"seventv-settings-backup-warning-container"},xe=x(()=>c("h5",{class:"seventv-settings-backup-warning"},"Settings unable to export/import:",-1)),$e=b({__name:"SettingsViewBackup",setup(s){const{platform:e}=oe(),t=k(!1),o=Q().map(i=>i.label).filter(i=>i!=="");async function _(){t.value=!1;try{const i=await K(),n=document.createElement("a");n.href=i,n.download=`7tv_settings_${e}-${new Date().toLocaleDateString()}.json`,n.click(),URL.revokeObjectURL(i)}catch(i){t.value=!0,S.error("failed to export settings",i.message)}}async function d(){t.value=!1;const i=await g();if(!i)return;const n=await C(i[0]);let v;try{v=JSON.parse(n)}catch(f){S.error("failed to parse settings file",f.message),t.value=!0;return}let u=[];try{u=W(v)}catch(f){S.error("failed to deserialize settings file",f.message),t.value=!0;return}S.debugWithObjects(["<Settings>","Deserialized settings file"],[u]);try{await Y(u),S.info("<Settings>","Loaded settings from file")}catch(f){S.error("failed to save settings from file",f.message),t.value=!0}}async function g(){return new Promise(i=>{const n=document.createElement("input");n.type="file",n.accept="application/json",n.onchange=()=>i(n.files),n.oncancel=()=>i(null),n.click()})}async function C(i){return new Promise((n,v)=>{const u=new FileReader;u.readAsText(i,"utf-8"),u.onload=()=>{n(u.result)},u.onerror=f=>v(f)})}return(i,n)=>(a(),r("main",he,[we,ye,c("div",Se,[w(R,{class:"seventv-settings-backup-button",onClick:_},{default:V(()=>[I("Export")]),_:1}),w(R,{class:"seventv-settings-backup-button",onClick:d},{default:V(()=>[I("Import")]),_:1})]),t.value?(a(),r("div",be,Ce)):y("",!0),l(o).length>0?(a(),r("div",Ve,[xe,(a(!0),r(E,null,A(l(o),v=>(a(),r("p",{key:v,class:"seventv-settings-backup-info"},h(v),1))),128))])):y("",!0)]))}});const Ie=m($e,[["__scopeId","data-v-616c201b"]]),Ee=s=>(O("data-v-a02322cc"),s=s(),U(),s),Ae={class:"seventv-settings-compat"},Te=Ee(()=>c("h3",null,[I(" Compatibility "),c("p",null,"Scan your extensions for compatibility issues")],-1)),Pe=["src"],Re=b({__name:"SettingsViewCompat",setup(s){const{browser:e}=se(),t=D(J,""),o=e.name!=="Firefox";return o||window.open(t+"#/compat","_blank"),(_,d)=>(a(),r("main",Ae,[Te,o?(a(),r("iframe",{key:0,src:l(t)+"#/compat?noheader=1"},null,8,Pe)):y("",!0)]))}});const Le=m(Re,[["__scopeId","data-v-a02322cc"]]),Ne=["sticky"],De=["id"],Oe=b({__name:"SettingsViewConfigCat",props:{name:{},nodes:{}},setup(s,{expose:e}){const t=s,o=q(),_=k(new Set(t.nodes.map(n=>n.key).filter(n=>!o.seen.includes(n)))),d=k(!1),g=k();ue(g,([n])=>{if(d.value=n.isIntersecting,!d.value)return;o.intersectingSubcategory=t.name;const v=n.target.getElementsByClassName("seventv-settings-node");for(const u of Array.from(v)){const f=u.getAttribute("data-key");f&&o.markSettingAsSeen(f)}},{threshold:.75,rootMargin:"0px 0px -50% 0px"});function C(n){_.value.delete(n),o.markSettingAsSeen(n)}function i(){var n;(n=g.value)==null||n.scrollIntoView({block:"start"})}return e({name:t.name,scrollIntoView:i}),(n,v)=>(a(),r("div",{ref_key:"catRef",ref:g,sticky:d.value,class:"seventv-settings-view-subcategory"},[n.name?(a(),r("h3",{key:0,id:n.name,ref:"subcategoryRefs",class:"seventv-settings-subcategory-header"},h(n.name),9,De)):y("",!0),(a(!0),r(E,null,A(n.nodes,u=>(a(),X(ie,{key:u.key,node:u,unseen:_.value.has(u.key),onSeen:f=>C(u.key)},null,8,["node","unseen","onSeen"]))),128))],8,Ne))}});const Ue=m(Oe,[["__scopeId","data-v-0d5231ad"]]),Be={key:0,class:"seventv-settings-view-container"},je=b({__name:"SettingsViewConfig",setup(s){const e=q(),t=k([]);return $(()=>e.scrollpoint,()=>{var o;(o=t.value.find(_=>_.name==e.scrollpoint))==null||o.scrollIntoView()}),(o,_)=>l(e).mappedNodes[l(e).category]?(a(),r("div",Be,[w(z,null,{default:V(()=>[(a(!0),r(E,null,A(Object.entries(l(e).mappedNodes[l(e).category]),([d,g])=>(a(),r("div",{key:d,class:"seventv-settings-subcategory"},[w(Ue,{ref_for:!0,ref_key:"subCats",ref:t,name:d,nodes:g},null,8,["name","nodes"])]))),128))]),_:1})])):y("",!0)}});const ze=m(je,[["__scopeId","data-v-c77af354"]]),qe={},Me={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",width:"1em",height:"1em",fill:"currentColor"},He=c("path",{d:"M0 480H144 512 640V352c0-59.6-40.8-109.8-96-124V192c0-53-43-96-96-96c-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32C167.6 32 96 103.6 96 192v8.2C40.1 220 0 273.3 0 336V480z"},null,-1),Fe=[He];function Ge(s,e){return a(),r("svg",Me,Fe)}const Qe=m(qe,[["render",Ge]]),Ke={class:"seventv-settings-home"},We={class:"seventv-settings-home-body"},Ye={class:"seventv-settings-home-changelog"},Je={class:"seventv-settings-home-footer"},Xe={class:"seventv-settings-app-info"},Ze={class:"seventv-settings-compact"},et={class:"seventv-version"},tt={key:0,class:"seventv-version-remote"},st={class:"seventv-settings-compact"},nt=b({__name:"SettingsViewHome",setup(s){const e="7TV",t={}.VITE_APP_CONTAINER??"Extension",o="https://7tv.io/v3",_="3.0.15.1000",d=seventv.hosted||!1;return(g,C)=>{const i=Z("tooltip");return a(),r("div",Ke,[c("div",We,[w(z,null,{default:V(()=>[c("div",Ye,[w(ae)])]),_:1}),c("div",Je,[c("div",Xe,[c("span",Ze,h(l(e))+" ("+h(l(t))+")",1),c("span",et,[c("span",null,"v"+h(l(_)),1),l(d)?ee((a(),r("span",tt,[w(Qe)])),[[i,"Running in Hosted Mode"]]):y("",!0)]),c("span",st,"API: "+h(l(o)),1)])])])])}}});const ot=m(nt,[["__scopeId","data-v-3c340c6b"]]),it={key:0},at=b({__name:"SettingsViewProfile",setup(s){const e=pe();return(t,o)=>l(e).user?(a(),r("div",it,"Hello "+h(l(e).user.display_name),1)):y("",!0)}});const rt=m(at,[["__scopeId","data-v-b8ec8afd"]]),ct=B(()=>j(()=>import("./seventv.PaintTool.3.0.15.1000.js"),["./seventv.PaintTool.3.0.15.1000.js","./seventv.index.3.0.15.1000.js","./seventv.preload-helper.3.0.15.1000.js","./seventv.useCosmetics.3.0.15.1000.js","./seventv.main.3.0.15.1000.js","./seventv.StoreSubscribeButton.3.0.15.1000.js","./seventv.ChevronIcon.3.0.15.1000.js","./seventv.v4.3.0.15.1000.js","./seventv.ChatMessage.3.0.15.1000.js","./seventv.UiFloating.3.0.15.1000.js","./seventv.index.3.0.15.10003.js"],import.meta.url)),ut=B(()=>j(()=>import("./seventv.Store.3.0.15.1000.js"),["./seventv.Store.3.0.15.1000.js","./seventv.index.3.0.15.1000.js","./seventv.preload-helper.3.0.15.1000.js"],import.meta.url));class lt{constructor(){p(this,"open",!1);p(this,"view",null);p(this,"category","");p(this,"scrollpoint","");p(this,"intersectingSubcategory","");p(this,"seen",[]);p(this,"mappedNodes",T({Home:{}}));this.switchView("home");const e=localStorage.getItem(P.SEEN_SETTINGS);if(e)for(const t of e.split(","))this.seen.push(t)}toggle(){this.open=!this.open}switchView(e){this.view=ne(_t[e])}markSettingAsSeen(...e){for(const t of e)this.seen.indexOf(t)===-1&&this.seen.push(t);localStorage.setItem(P.SEEN_SETTINGS,this.seen.join(","))}}const _t={home:ot,config:ze,profile:rt,compat:Le,backup:Ie,store:ut,paint:ct},pt=T(new lt);function q(){return pt}export{St as D,q as a,pe as u};
